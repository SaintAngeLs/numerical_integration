Funkcja testująca moduł programu 'doubletrap' odpowiadający za zastowowanie złożonego wzoru trapezów ze względu na każdą zmienną, ma na celu ocenę własności zbieżności złożonej metody trapezów do przybliżania podwójnych całek.
Jako funkcję testową wybrano następujące funkcje:
f(x, y) = sin(x) * cos(y), f(x, y) = x^2 + y^2), f(x, y) = exp(-x.^2-y.^2), wartość całki podwójnej z których dla przedziałów całkowania [-8/9, 5/6] oraz [-8/9, 5/6] odpowiednio dla pierwszej i dla drugiej zmiennej wynoszą (sin(5/6) + sin(8/9))*(-cos(5/6) + cos(8/9)), 231601/157464, 1/4 * pi * (erf(5/6) + erf(8/9))^2.
Test zaczyna się od 10 podziałów i sukcesywnie podwaja ich liczbę. Celem jest sprawdzenie, jak szybko błąd przybliżenia całki podwójnej maleje wraz ze zwiększaniem liczby podziałów przedziału całkowania. Metoda trapezów jest metodą drugiego rzędu, co oznacza, że błąd powinien teoretycznie zmniejszać się proporcjonalnie do kwadratu długości kroku siatki (h^2).
Wartość rate (wartość rzędu metody) jest obliczana jako logarytm przy podstawie 2 z ilorazu dwóch kolejnych błędów. Jeśli metoda ma rząd k, to przy podwojeniu liczby podziałów (zwiększeniu rozdzielczości siatki) błąd powinien teoretycznie zmniejszyć się 2^k razy.
